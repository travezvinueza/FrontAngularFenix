"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[3477],{3477:(Qt,M,c)=>{c.r(M),c.d(M,{ScrumboardModule:()=>N});var _=c(1390),x=c(1206),m=c(4859),G=c(6709),R=c(7274),W=c(3238),v=c(148),q=c(9549),y=c(7392),$=c(284),j=c(9506),S=c(8255),tt=c(3162),et=c(4466),V=c(7579),k=c(2722),T=c(1837),t=c(4650),Y=c(1135),u=c(4004),f=c(8505),b=c(5698),g=c(3900),z=c(2843),it=c(9646);class E{constructor(i){this.id=i.id||null,this.title=i.title,this.description=i.description||null,this.icon=i.icon||null,this.lastActivity=i.lastActivity||null,this.lists=[],this.labels=[],this.members=[],i.lists&&(this.lists=i.lists.map(e=>e instanceof C?e:new C(e))),i.labels&&(this.labels=i.labels.map(e=>e instanceof J?e:new J(e))),i.members&&(this.members=i.members.map(e=>e instanceof K?e:new K(e)))}}class C{constructor(i){this.id=i.id||null,this.boardId=i.boardId,this.position=i.position,this.title=i.title,this.cards=[],i.cards&&(this.cards=i.cards.map(e=>e instanceof w?e:new w(e)))}}class w{constructor(i){this.id=i.id||null,this.boardId=i.boardId,this.listId=i.listId,this.position=i.position,this.title=i.title,this.description=i.description||null,this.labels=[],this.dueDate=i.dueDate||null,i.labels&&(this.labels=i.labels.map(e=>e instanceof J?e:new J(e)))}}class K{constructor(i){this.id=i.id||null,this.name=i.name,this.avatar=i.avatar||null}}class J{constructor(i){this.id=i.id||null,this.boardId=i.boardId,this.title=i.title}}var rt=c(529);class h{constructor(i){this._httpClient=i,this._board=new Y.X(null),this._boards=new Y.X(null),this._card=new Y.X(null)}get board$(){return this._board.asObservable()}get boards$(){return this._boards.asObservable()}get card$(){return this._card.asObservable()}getBoards(){return this._httpClient.get("api/apps/scrumboard/boards").pipe((0,u.U)(i=>i.map(e=>new E(e))),(0,f.b)(i=>this._boards.next(i)))}getBoard(i){return this._httpClient.get("api/apps/scrumboard/board",{params:{id:i}}).pipe((0,u.U)(e=>new E(e)),(0,f.b)(e=>this._board.next(e)))}createBoard(i){return this.boards$.pipe((0,b.q)(1),(0,g.w)(e=>this._httpClient.put("api/apps/scrumboard/board",{board:i}).pipe((0,u.U)(r=>(this._boards.next([...e,r]),r)))))}updateBoard(i,e){return this.boards$.pipe((0,b.q)(1),(0,g.w)(r=>this._httpClient.patch("api/apps/scrumboard/board",{id:i,board:e}).pipe((0,u.U)(n=>{const o=r.findIndex(a=>a.id===i);return r[o]=n,this._boards.next(r),n}))))}deleteBoard(i){return this.boards$.pipe((0,b.q)(1),(0,g.w)(e=>this._httpClient.delete("api/apps/scrumboard/board",{params:{id:i}}).pipe((0,u.U)(r=>{const n=e.findIndex(o=>o.id===i);return e.splice(n,1),this._boards.next(e),this._board.next(null),this._card.next(null),r}))))}createList(i){return this._httpClient.post("api/apps/scrumboard/board/list",{list:i}).pipe((0,u.U)(e=>new C(e)),(0,f.b)(e=>{const r=this._board.value;r.lists=[...r.lists,e],r.lists.sort((n,o)=>n.position-o.position),this._board.next(r)}))}updateList(i){return this._httpClient.patch("api/apps/scrumboard/board/list",{list:i}).pipe((0,u.U)(e=>new C(e)),(0,f.b)(e=>{const r=this._board.value,n=r.lists.findIndex(o=>o.id===i.id);r.lists[n]=e,r.lists.sort((o,a)=>o.position-a.position),this._board.next(r)}))}updateLists(i){return this._httpClient.patch("api/apps/scrumboard/board/lists",{lists:i}).pipe((0,u.U)(e=>e.map(r=>new C(r))),(0,f.b)(e=>{const r=this._board.value;e.forEach(n=>{const o=r.lists.findIndex(a=>a.id===n.id);r.lists[o]=n}),r.lists.sort((n,o)=>n.position-o.position),this._board.next(r)}))}deleteList(i){return this._httpClient.delete("api/apps/scrumboard/board/list",{params:{id:i}}).pipe((0,f.b)(e=>{const r=this._board.value,n=r.lists.findIndex(o=>o.id===i);r.lists.splice(n,1),r.lists.sort((o,a)=>o.position-a.position),this._board.next(r)}))}getCard(i){return this._board.pipe((0,b.q)(1),(0,u.U)(e=>{const r=e.lists.find(n=>n.cards.some(o=>o.id===i)).cards.find(n=>n.id===i);return this._card.next(r),r}),(0,g.w)(e=>e?(0,it.of)(e):(0,z._)("Could not found the card with id of "+i+"!")))}createCard(i){return this._httpClient.put("api/apps/scrumboard/board/card",{card:i}).pipe((0,u.U)(e=>new w(e)),(0,f.b)(e=>{const r=this._board.value;return r.lists.forEach((n,o,a)=>{n.id===e.listId&&a[o].cards.push(e)}),this._board.next(r),e}))}updateCard(i,e){return this.board$.pipe((0,b.q)(1),(0,g.w)(r=>this._httpClient.patch("api/apps/scrumboard/board/card",{id:i,card:e}).pipe((0,u.U)(n=>(r.lists.forEach(o=>{o.cards.forEach((a,l,D)=>{a.id===i&&(D[l]=n)})}),this._board.next(r),this._card.next(n),n)))))}updateCards(i){return this._httpClient.patch("api/apps/scrumboard/board/cards",{cards:i}).pipe((0,u.U)(e=>e.map(r=>new w(r))),(0,f.b)(e=>{const r=this._board.value;e.forEach(n=>{const o=r.lists.findIndex(l=>l.id===n.listId),a=r.lists[o].cards.findIndex(l=>l.id===n.id);r.lists[o].cards[a]=n,r.lists[o].cards.sort((l,D)=>l.position-D.position)}),this._board.next(r)}))}deleteCard(i){return this.board$.pipe((0,b.q)(1),(0,g.w)(e=>this._httpClient.delete("api/apps/scrumboard/board/card",{params:{id:i}}).pipe((0,u.U)(r=>(e.lists.forEach(n=>{n.cards.forEach((o,a,l)=>{o.id===i&&l.splice(a,1)})}),this._board.next(e),this._card.next(null),r)))))}updateCardPositions(i){}createLabel(i){return this.board$.pipe((0,b.q)(1),(0,g.w)(e=>this._httpClient.post("api/apps/scrumboard/board/label",{label:i}).pipe((0,u.U)(r=>(e.labels=[...e.labels,r],this._board.next(e),r)))))}updateLabel(i,e){return this.board$.pipe((0,b.q)(1),(0,g.w)(r=>this._httpClient.patch("api/apps/scrumboard/board/label",{id:i,label:e}).pipe((0,u.U)(n=>{const o=r.labels.findIndex(a=>a.id===i);return r.labels[o]=n,this._board.next(r),n}))))}deleteLabel(i){return this.board$.pipe((0,b.q)(1),(0,g.w)(e=>this._httpClient.delete("api/apps/scrumboard/board/label",{params:{id:i}}).pipe((0,u.U)(r=>{const n=e.labels.findIndex(o=>o.id===i);return e.labels.splice(n,1),r&&e.lists.forEach(o=>{o.cards.forEach(a=>{const l=a.labels.findIndex(D=>D.id===i);l>-1&&a.labels.splice(l,1)})}),this._board.next(e),r}))))}search(i){return this._httpClient.get("api/apps/scrumboard/board/search",{params:{query:i}})}static#t=this.\u0275fac=function(e){return new(e||h)(t.LFG(rt.eN))};static#e=this.\u0275prov=t.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}var H=c(7376),p=c(6895);function nt(s,i){if(1&s&&(t.ynx(0),t._UZ(1,"img",18),t.BQk()),2&s){const e=i.$implicit;t.xp6(1),t.Q6J("src",e.avatar,t.LSH)}}function ot(s,i){if(1&s&&(t.ynx(0),t.TgZ(1,"div",19)(2,"div",20),t._uU(3),t.qZA()(),t.BQk()),2&s){const e=t.oxw(2).$implicit;t.xp6(3),t.hij(" +",e.members.slice(5).length," ")}}function st(s,i){if(1&s&&(t.ynx(0),t._UZ(1,"div",16),t.TgZ(2,"div",17),t.YNc(3,nt,2,1,"ng-container",4),t.YNc(4,ot,4,1,"ng-container",12),t.qZA(),t.BQk()),2&s){const e=t.oxw().$implicit,r=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.members.slice(0,5))("ngForTrackBy",r.trackByFn),t.xp6(1),t.Q6J("ngIf",e.members.length>5)}}const at=function(s){return[s]};function ct(s,i){if(1&s&&(t.ynx(0),t.TgZ(1,"a",7)(2,"div",8),t._UZ(3,"mat-icon",9),t.qZA(),t.TgZ(4,"div",10),t._uU(5),t.qZA(),t.TgZ(6,"div",11),t._uU(7),t.qZA(),t.YNc(8,st,5,3,"ng-container",12),t.TgZ(9,"div",13)(10,"div",14),t._uU(11,"Edited:"),t.qZA(),t.TgZ(12,"div",15),t._uU(13),t.qZA()()(),t.BQk()),2&s){const e=i.$implicit,r=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(6,at,e.id)),t.xp6(2),t.Q6J("svgIcon",e.icon),t.xp6(2),t.Oqu(e.title),t.xp6(2),t.Oqu(e.description),t.xp6(1),t.Q6J("ngIf",null==e.members?null:e.members.length),t.xp6(5),t.Oqu(r.formatDateAsRelative(e.lastActivity))}}class B{constructor(i,e){this._changeDetectorRef=i,this._scrumboardService=e,this._unsubscribeAll=new V.x}ngOnInit(){this._scrumboardService.boards$.pipe((0,k.R)(this._unsubscribeAll)).subscribe(i=>{this.boards=i,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}formatDateAsRelative(i){return T.ou.fromISO(i).toRelative()}trackByFn(i,e){return e.id||i}static#t=this.\u0275fac=function(e){return new(e||B)(t.Y36(t.sBO),t.Y36(h))};static#e=this.\u0275cmp=t.Xpm({type:B,selectors:[["scrumboard-boards"]],decls:8,vars:3,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-auto","items-center","p-6","sm:p-10"],[1,"mt-4","md:mt-24","text-3xl","md:text-6xl","font-extrabold","tracking-tight","leading-7","sm:leading-10"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4","mt-8","md:mt-16"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-col","items-center","justify-center","w-56","rounded-lg","cursor-pointer","border-2","border-gray-300","border-dashed","hover:bg-hover","transition-colors","duration-150","ease-in-out"],[1,"icon-size-12","text-hint",3,"svgIcon"],[1,"flex","flex-col","items-start","w-56","p-6","rounded-lg","shadow","bg-card","rounded-lg","hover:shadow-xl","transition-shadow","duration-150","ease-in-out",3,"routerLink"],[1,"flex","items-center","justify-center","p-4","rounded-full","bg-primary-50","text-primary-700","dark:bg-primary","dark:text-on-primary"],[1,"text-current",3,"svgIcon"],[1,"mt-5","text-lg","font-medium","leading-5"],[1,"mt-0.5","line-clamp-2","text-secondary"],[4,"ngIf"],[1,"flex","items-center","mt-4","text-md","font-md"],[1,"text-secondary"],[1,"ml-1"],[1,"w-12","h-1","mt-6","border-t-2"],[1,"flex","items-center","mt-6","-space-x-1.5"],["alt","Member avatar",1,"flex-0","w-8","h-8","rounded-full","ring","ring-offset-1","ring-bg-card","ring-offset-transparent","object-cover",3,"src"],[1,"flex","flex-0","items-center","justify-center","w-8","h-8","rounded-full","ring","ring-offset-1","ring-bg-card","ring-offset-transparent","bg-gray-200","text-gray-500"],[1,"text-md","font-semibold"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3," Scrumboard Boards "),t.qZA(),t.TgZ(4,"div",3),t.YNc(5,ct,14,8,"ng-container",4),t.TgZ(6,"div",5),t._UZ(7,"mat-icon",6),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("ngForOf",r.boards)("ngForTrackBy",r.trackByFn),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:plus"))},dependencies:[_.rH,H.PQ,y.Hw,p.sg,p.O5],encapsulation:2,changeDetection:0})}var P=c(262);class Z{constructor(i){this._scrumboardService=i}resolve(i,e){return this._scrumboardService.getBoards()}static#t=this.\u0275fac=function(e){return new(e||Z)(t.LFG(h))};static#e=this.\u0275prov=t.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"})}class A{constructor(i,e){this._router=i,this._scrumboardService=e}resolve(i,e){return this._scrumboardService.getBoard(i.paramMap.get("boardId")).pipe((0,P.K)(r=>{console.error(r);const n=e.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(n),(0,z._)(r)}))}static#t=this.\u0275fac=function(e){return new(e||A)(t.LFG(_.F0),t.LFG(h))};static#e=this.\u0275prov=t.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"})}class I{constructor(i,e){this._router=i,this._scrumboardService=e}resolve(i,e){return this._scrumboardService.getCard(i.paramMap.get("cardId")).pipe((0,P.K)(r=>{console.error(r);const n=e.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(n),(0,z._)(r)}))}static#t=this.\u0275fac=function(e){return new(e||I)(t.LFG(_.F0),t.LFG(h))};static#e=this.\u0275prov=t.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"})}var d=c(4006),dt=c(7401),X=c(9349);const lt=["titleInput"],ut=["titleAutosize"],pt=function(s){return{"opacity-0 pointer-events-none":s}},mt=function(s){return{"opacity-0":s}};class L{constructor(i,e){this._changeDetectorRef=i,this._formBuilder=e,this.buttonTitle="Add a card",this.saved=new t.vpe,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){const i=this.form.get("title").value;!i||""===i.trim()||(this.saved.next(i.trim()),this.formVisible=!1,this.form.get("title").setValue(""),setTimeout(()=>{this.titleInput.nativeElement.value="",this.titleAutosize.reset()}),this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}static#t=this.\u0275fac=function(e){return new(e||L)(t.Y36(t.sBO),t.Y36(d.QS))};static#e=this.\u0275cmp=t.Xpm({type:L,selectors:[["scrumboard-board-add-card"]],viewQuery:function(e,r){if(1&e&&(t.Gf(lt,5),t.Gf(ut,5)),2&e){let n;t.iGM(n=t.CRH())&&(r.titleInput=n.first),t.iGM(n=t.CRH())&&(r.titleAutosize=n.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},decls:17,vars:18,consts:[[1,"p-3","pt-0"],[1,"relative","flex","w-full","h-full","rounded-lg"],["mat-button","","disableRipple","",1,"absolute","inset-0","justify-start","w-full","rounded-lg",3,"ngClass","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","text-secondary"],[1,"flex","flex-col","items-start","w-full",3,"ngClass","formGroup"],[1,"flex","w-full","p-5","rounded-lg","shadow","bg-card"],["cdkTextareaAutosize","",1,"w-full","text-lg","font-medium","leading-5",3,"spellcheck","formControlName","placeholder","keydown.enter"],["titleInput","","titleAutosize","cdkTextareaAutosize"],[1,"flex","items-center","mt-2"],["mat-flat-button","",1,"h-8","min-h-8",3,"color","type","click"],["mat-icon-button","",1,"ml-1","w-8","h-8","min-h-8",3,"type","click"],[1,"icon-size-4",3,"svgIcon"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return r.toggleFormVisibility()}),t._UZ(3,"mat-icon",3),t.TgZ(4,"span",4),t._uU(5),t.qZA()(),t.TgZ(6,"form",5)(7,"div",6)(8,"textarea",7,8),t.NdJ("keydown.enter",function(){return r.save()}),t._uU(11,"                "),t.qZA()(),t.TgZ(12,"div",9)(13,"button",10),t.NdJ("click",function(){return r.save()}),t._uU(14," Add card "),t.qZA(),t.TgZ(15,"button",11),t.NdJ("click",function(){return r.toggleFormVisibility()}),t._UZ(16,"mat-icon",12),t.qZA()()()()()),2&e&&(t.ekj("h-13",!r.formVisible),t.xp6(2),t.Q6J("ngClass",t.VKq(14,pt,r.formVisible)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus-circle"),t.xp6(2),t.Oqu(r.buttonTitle),t.xp6(1),t.Q6J("ngClass",t.VKq(16,mt,!r.formVisible))("formGroup",r.form),t.xp6(2),t.Q6J("spellcheck","off")("formControlName","title")("placeholder","Enter card title..."),t.xp6(5),t.Q6J("color","primary")("type","button"),t.xp6(2),t.Q6J("type","button"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:x"))},dependencies:[m.lW,m.RK,y.Hw,X.IC,p.mk,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u],encapsulation:2,changeDetection:0})}const ht=["titleInput"],ft=function(s){return{"opacity-0 pointer-events-none":s}},bt=function(s){return{"opacity-0":s}};class Q{constructor(i,e){this._changeDetectorRef=i,this._formBuilder=e,this.buttonTitle="Add a list",this.saved=new t.vpe,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){const i=this.form.get("title").value;!i||""===i.trim()||(this.saved.next(i.trim()),this.form.get("title").setValue(""),this.formVisible=!1,this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}static#t=this.\u0275fac=function(e){return new(e||Q)(t.Y36(t.sBO),t.Y36(d.QS))};static#e=this.\u0275cmp=t.Xpm({type:Q,selectors:[["scrumboard-board-add-list"]],viewQuery:function(e,r){if(1&e&&t.Gf(ht,5),2&e){let n;t.iGM(n=t.CRH())&&(r.titleInput=n.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},decls:14,vars:18,consts:[[1,"mt-11","w-64","py-2.5","px-2"],[1,"relative","flex","w-full","h-full","overflow-hidden","rounded-xl","bg-gray-200","dark:bg-gray-700"],["mat-button","","disableRipple","",1,"absolute","inset-0","justify-start","w-full","px-3","rounded-xl","bg-transparent",3,"ngClass","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","text-secondary"],[1,"flex","flex-col","items-start","w-full","p-3",3,"ngClass","formGroup"],[1,"w-full","py-2","px-3","leading-5","rounded-md","shadow-sm","border","border-gray-300","bg-white","focus:border-primary","dark:border-gray-500","dark:focus:border-primary","dark:bg-black","dark:bg-opacity-5",3,"autocomplete","formControlName","placeholder","keydown.enter"],["titleInput",""],[1,"flex","items-center","mt-2"],["mat-flat-button","",1,"h-8","min-h-8",3,"color","type","click"],["mat-icon-button","",1,"ml-1","w-8","h-8","min-h-8",3,"type","click"],[1,"icon-size-4",3,"svgIcon"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return r.toggleFormVisibility()}),t._UZ(3,"mat-icon",3),t.TgZ(4,"span",4),t._uU(5),t.qZA()(),t.TgZ(6,"form",5)(7,"input",6,7),t.NdJ("keydown.enter",function(){return r.save()}),t.qZA(),t.TgZ(9,"div",8)(10,"button",9),t.NdJ("click",function(){return r.save()}),t._uU(11," Add list "),t.qZA(),t.TgZ(12,"button",10),t.NdJ("click",function(){return r.toggleFormVisibility()}),t._UZ(13,"mat-icon",11),t.qZA()()()()()),2&e&&(t.ekj("h-15",!r.formVisible),t.xp6(2),t.Q6J("ngClass",t.VKq(14,ft,r.formVisible)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus-circle"),t.xp6(2),t.Oqu(r.buttonTitle),t.xp6(1),t.Q6J("ngClass",t.VKq(16,bt,!r.formVisible))("formGroup",r.form),t.xp6(1),t.Q6J("autocomplete","off")("formControlName","title")("placeholder","Enter list title..."),t.xp6(3),t.Q6J("color","primary")("type","button"),t.xp6(2),t.Q6J("type","button"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:x"))},dependencies:[m.lW,m.RK,y.Hw,p.mk,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u],encapsulation:2,changeDetection:0})}function gt(s,i){if(1&s&&(t.ynx(0),t.TgZ(1,"div",30),t._UZ(2,"img",31),t.qZA(),t.BQk()),2&s){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("src",e.coverImage,t.LSH)}}function _t(s,i){if(1&s&&(t.ynx(0),t.TgZ(1,"div",33),t._uU(2),t.qZA(),t.BQk()),2&s){const e=i.$implicit;t.xp6(2),t.hij(" ",e.title," ")}}function xt(s,i){if(1&s&&(t.ynx(0),t.TgZ(1,"div")(2,"div",32),t.YNc(3,_t,3,1,"ng-container",12),t.qZA()(),t.BQk()),2&s){const e=t.oxw().$implicit,r=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",e.labels)("ngForTrackBy",r.trackByFn)}}const vt=function(s){return{"text-red-600":s}};function yt(s,i){if(1&s&&(t.ynx(0),t.TgZ(1,"div",34),t._UZ(2,"mat-icon",35),t.TgZ(3,"div",21),t._uU(4),t.ALo(5,"date"),t.qZA()(),t.BQk()),2&s){const e=t.oxw().$implicit,r=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.VKq(6,vt,r.isOverdue(e.dueDate))),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:clock"),t.xp6(2),t.hij(" ",t.xi3(5,3,e.dueDate,"longDate")," ")}}const Ct=function(s){return["card",s]};function kt(s,i){if(1&s&&(t.ynx(0),t.TgZ(1,"a",27),t.YNc(2,gt,3,1,"ng-container",28),t.TgZ(3,"div",29),t._uU(4),t.qZA(),t.YNc(5,xt,4,2,"ng-container",28),t.YNc(6,yt,6,8,"ng-container",28),t.qZA(),t.BQk()),2&s){const e=i.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(5,Ct,e.id)),t.xp6(1),t.Q6J("ngIf",e.coverImage),t.xp6(2),t.Oqu(e.title),t.xp6(1),t.Q6J("ngIf",e.labels.length),t.xp6(1),t.Q6J("ngIf",e.dueDate)}}function Tt(s,i){if(1&s){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",15)(2,"div",16)(3,"div",17)(4,"input",18,19),t.NdJ("focusout",function(n){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.updateListTitle(n,a))})("keydown.enter",function(){t.CHM(e);const n=t.MAs(5);return t.KtG(n.blur())}),t.qZA()(),t.TgZ(6,"div",20),t._uU(7),t.qZA(),t.TgZ(8,"div",21)(9,"button",22),t._UZ(10,"mat-icon",6),t.qZA(),t.TgZ(11,"mat-menu",null,23)(13,"button",24),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(5),o=t.oxw();return t.KtG(o.renameList(n))}),t._UZ(14,"mat-icon",6),t._uU(15," Rename list "),t.qZA(),t.TgZ(16,"button",24),t.NdJ("click",function(){const o=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.deleteList(o.id))}),t._UZ(17,"mat-icon",6),t._uU(18," Delete list "),t.qZA()()()(),t.TgZ(19,"div",25)(20,"div",26),t.NdJ("cdkDropListDropped",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.cardDropped(n))}),t.YNc(21,kt,7,7,"ng-container",12),t.qZA(),t.TgZ(22,"scrumboard-board-add-card",13),t.NdJ("saved",function(n){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.addCard(a,n))}),t.qZA()()(),t.BQk()}if(2&s){const e=i.$implicit,r=t.MAs(12),n=t.oxw();t.xp6(1),t.Q6J("cdkDragLockAxis","x"),t.xp6(3),t.Q6J("spellcheck","false")("value",e.title),t.xp6(3),t.hij(" ",e.cards.length," "),t.xp6(2),t.Q6J("matMenuTriggerFor",r),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:dots-vertical"),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:pencil-alt"),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:trash"),t.xp6(3),t.Q6J("id",e.id)("cdkDropListData",e.cards),t.xp6(1),t.Q6J("ngForOf",e.cards)("ngForTrackBy",n.trackByFn),t.xp6(1),t.Q6J("buttonTitle",e.cards.length?"Add another card":"Add a card")}}const wt=function(){return[".."]};class F{constructor(i,e,r,n){this._changeDetectorRef=i,this._formBuilder=e,this._fuseConfirmationService=r,this._scrumboardService=n,this._positionStep=65536,this._maxListCount=200,this._maxPosition=500*this._positionStep,this._unsubscribeAll=new V.x}ngOnInit(){this.listTitleForm=this._formBuilder.group({title:[""]}),this._scrumboardService.board$.pipe((0,k.R)(this._unsubscribeAll)).subscribe(i=>{this.board={...i},this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}renameList(i){setTimeout(()=>{i.focus()})}addList(i){if(this.board.lists.length>=this._maxListCount)return;const e=new C({boardId:this.board.id,position:this.board.lists.length?this.board.lists[this.board.lists.length-1].position+this._positionStep:this._positionStep,title:i});this._scrumboardService.createList(e).subscribe()}updateListTitle(i,e){const r=i.target,n=r.value;n&&""!==n.trim()?(e.title=r.value=n.trim(),this._scrumboardService.updateList(e).subscribe()):r.value=e.title}deleteList(i){this._fuseConfirmationService.open({title:"Delete list",message:"Are you sure you want to delete this list and its cards? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._scrumboardService.deleteList(i).subscribe()})}addCard(i,e){const r=new w({boardId:this.board.id,listId:i.id,position:i.cards.length?i.cards[i.cards.length-1].position+this._positionStep:this._positionStep,title:e});this._scrumboardService.createCard(r).subscribe()}listDropped(i){(0,x.bA)(i.container.data,i.previousIndex,i.currentIndex);const e=this._calculatePositions(i);this._scrumboardService.updateLists(e).subscribe()}cardDropped(i){i.previousContainer===i.container?(0,x.bA)(i.container.data,i.previousIndex,i.currentIndex):((0,x.EA)(i.previousContainer.data,i.container.data,i.previousIndex,i.currentIndex),i.container.data[i.currentIndex].listId=i.container.id);const e=this._calculatePositions(i);this._scrumboardService.updateCards(e).subscribe()}isOverdue(i){return T.ou.fromISO(i).startOf("day")<T.ou.now().startOf("day")}trackByFn(i,e){return e.id||i}_calculatePositions(i){let e=i.container.data;const r=e[i.currentIndex],n=e[i.currentIndex-1]||null,o=e[i.currentIndex+1]||null;return r.position=n?o?(n.position+o.position)/2:n.position+this._positionStep:o?o.position/2:this._positionStep,!Number.isInteger(r.position)||r.position>=this._maxPosition?(e=e.map((a,l)=>(a.position=(l+1)*this._positionStep,a)),e):[r]}static#t=this.\u0275fac=function(e){return new(e||F)(t.Y36(t.sBO),t.Y36(d.QS),t.Y36(dt.R),t.Y36(h))};static#e=this.\u0275cmp=t.Xpm({type:F,selectors:[["scrumboard-board"]],decls:21,vars:10,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","p-6","sm:py-8","sm:px-10","border-b","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],["mat-stroked-button","",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],["mat-stroked-button","",1,"ml-3"],["cdkScrollable","",1,"flex-auto","p-6","sm:p-8","sm:pt-4","overflow-y-auto"],["cdkDropList","",1,"flex",3,"cdkDropListData","cdkDropListOrientation","cdkDropListDropped"],["cdkDropListGroup","",1,"flex","items-start"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"buttonTitle","saved"],[1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none"],["cdkDrag","",1,"flex-0","w-72","p-2","rounded-2xl","bg-default",3,"cdkDragLockAxis"],["cdkDragHandle","",1,"flex","items-center","justify-between"],[1,"flex","items-center","w-full","py-2","px-3","rounded-md","cursor-text","border","border-transparent","focus-within:bg-white","focus-within:shadow-sm","focus-within:border-primary","dark:focus-within:bg-gray-900"],[1,"w-full","font-medium","leading-5","bg-transparent",3,"spellcheck","value","focusout","keydown.enter"],["listTitleInput",""],[1,"flex","items-center","justify-center","min-w-6","ml-4","text-sm","font-semibold","leading-6","rounded-full","bg-gray-300","text-secondary","dark:bg-gray-700"],[1,"ml-1"],["mat-icon-button","",1,"w-8","h-8","min-h-8",3,"matMenuTriggerFor"],["listMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"mt-2","rounded-xl","bg-gray-400","bg-opacity-12","dark:bg-transparent","dark:border"],["cdkDropList","",1,"p-3","pb-0",3,"id","cdkDropListData","cdkDropListDropped"],["cdkDrag","",1,"flex","flex-col","items-start","mb-3","p-5","space-y-3","shadow","rounded-lg","overflow-hidden","bg-card",3,"routerLink"],[4,"ngIf"],[1,"text-lg","font-medium","leading-5"],[1,"-mx-5","-mt-5","mb-2"],[1,"w-full","object-cover",3,"src"],[1,"flex","flex-wrap","-mx-1","-mb-2"],[1,"mx-1","mb-2","py-0.5","px-3","rounded-full","text-sm","font-medium","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700"],[1,"flex","items-center","rounded","text-sm","font-medium","leading-5","text-secondary",3,"ngClass"],[1,"icon-size-4","text-current",3,"svgIcon"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4),t.qZA()(),t.TgZ(5,"div",4)(6,"a",5),t._UZ(7,"mat-icon",6),t.TgZ(8,"span",7),t._uU(9,"Boards"),t.qZA()(),t.TgZ(10,"button",8),t._UZ(11,"mat-icon",6),t.TgZ(12,"span",7),t._uU(13,"Settings"),t.qZA()()()(),t.TgZ(14,"div",9)(15,"div",10),t.NdJ("cdkDropListDropped",function(o){return r.listDropped(o)}),t.TgZ(16,"div",11),t.YNc(17,Tt,23,13,"ng-container",12),t.TgZ(18,"scrumboard-board-add-list",13),t.NdJ("saved",function(o){return r.addList(o)}),t.qZA()()()()(),t.TgZ(19,"div",14),t._UZ(20,"router-outlet"),t.qZA()),2&e&&(t.xp6(4),t.hij(" ",r.board.title," "),t.xp6(2),t.Q6J("routerLink",t.DdM(9,wt)),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:view-boards"),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:cog"),t.xp6(4),t.Q6J("cdkDropListData",r.board.lists)("cdkDropListOrientation","horizontal"),t.xp6(2),t.Q6J("ngForOf",r.board.lists)("ngForTrackBy",r.trackByFn),t.xp6(1),t.Q6J("buttonTitle",r.board.lists.length?"Add another list":"Add a list"))},dependencies:[_.lC,_.rH,H.PQ,x.Wj,x.Fd,x.Zt,x.Bh,m.zs,m.lW,m.RK,y.Hw,S.VK,S.OP,S.p6,p.mk,p.sg,p.O5,L,Q,p.uU],styles:[".cdk-drag-preview{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.cdk-drag-placeholder{opacity:0}.cdk-drag-animating{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging div:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}\n"],encapsulation:2,changeDetection:0})}var Zt=c(8372),At=c(9858);const It=["labelInput"];function Dt(s,i){if(1&s&&(t.ynx(0),t._uU(1),t.ALo(2,"date"),t.BQk()),2&s){const e=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,e.card.dueDate,"longDate"))}}function St(s,i){1&s&&(t.ynx(0),t._uU(1,"Not set"),t.BQk())}function Jt(s,i){if(1&s){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-checkbox",26),t.NdJ("change",function(n){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.toggleProductTag(a,n))}),t._uU(2),t.qZA(),t.BQk()}if(2&s){const e=i.$implicit,r=t.oxw();t.xp6(1),t.Q6J("color","primary")("checked",r.hasLabel(e)),t.xp6(1),t.hij(" ",e.title," ")}}const Bt=function(s,i,e){return{"text-gray-500 bg-gray-100 dark:text-gray-300 dark:bg-gray-700":s,"text-green-800 bg-green-200 dark:text-green-100 dark:bg-green-500":i,"text-red-800 bg-red-200 dark:text-red-100 dark:bg-red-500":e}};class U{constructor(i,e,r,n){this.matDialogRef=i,this._changeDetectorRef=e,this._formBuilder=r,this._scrumboardService=n,this._unsubscribeAll=new V.x}ngOnInit(){this._scrumboardService.board$.pipe((0,k.R)(this._unsubscribeAll)).subscribe(i=>{this.board=i,this.labels=this.filteredLabels=i.labels}),this._scrumboardService.card$.pipe((0,k.R)(this._unsubscribeAll)).subscribe(i=>{this.card=i}),this.cardForm=this._formBuilder.group({id:[""],title:["",d.kI.required],description:[""],labels:[[]],dueDate:[null]}),this.cardForm.setValue({id:this.card.id,title:this.card.title,description:this.card.description,labels:this.card.labels,dueDate:this.card.dueDate}),this.cardForm.valueChanges.pipe((0,f.b)(i=>{this.card=(0,At.Z)(this.card,i)}),(0,Zt.b)(300),(0,k.R)(this._unsubscribeAll)).subscribe(i=>{this._scrumboardService.updateCard(i.id,i).subscribe(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}hasLabel(i){return!!this.card.labels.find(e=>e.id===i.id)}filterLabels(i){const e=i.target.value.toLowerCase();this.filteredLabels=this.labels.filter(r=>r.title.toLowerCase().includes(e))}filterLabelsInputKeyDown(i){if("Enter"!==i.key||0===this.filteredLabels.length)return;const e=this.filteredLabels[0];this.card.labels.find(n=>n.id===e.id)?this.removeLabelFromCard(e):this.addLabelToCard(e)}toggleProductTag(i,e){e.checked?this.addLabelToCard(i):this.removeLabelFromCard(i)}addLabelToCard(i){this.card.labels.unshift(i),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}removeLabelFromCard(i){this.card.labels.splice(this.card.labels.findIndex(e=>e.id===i.id),1),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}isOverdue(i){return T.ou.fromISO(i).startOf("day")<T.ou.now().startOf("day")}trackByFn(i,e){return e.id||i}_readAsDataURL(i){return new Promise((e,r)=>{const n=new FileReader;n.onload=()=>{e(n.result)},n.onerror=o=>{r(o)},n.readAsDataURL(i)})}static#t=this.\u0275fac=function(e){return new(e||U)(t.Y36(R.so),t.Y36(t.sBO),t.Y36(d.QS),t.Y36(h))};static#e=this.\u0275cmp=t.Xpm({type:U,selectors:[["scrumboard-card-details"]],viewQuery:function(e,r){if(1&e&&t.Gf(It,5),2&e){let n;t.iGM(n=t.CRH())&&(r.labelInput=n.first)}},decls:44,vars:27,consts:[[1,"flex","flex-col","flex-auto","md:w-160","md:min-w-160","max-h-160","-m-6","overflow-y-auto"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"tabIndex","click"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-0","items-start","w-full","p-6","sm:p-8","space-y-6","overflow-y-auto",3,"formGroup"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"formControlName","rows","cdkAutosizeMinRows"],[1,"font-medium"],[1,"relative","flex","items-center","mt-1.5","px-4","leading-9","rounded-full","cursor-pointer",3,"ngClass","click"],[1,"icon-size-5","text-current",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[4,"ngIf"],[1,"fuse-mat-dense","invisible","absolute","inset-0","-mt-2.5","opacity-0","pointer-events-none",3,"subscriptSizing"],["matInput","",3,"formControlName","matDatepicker"],["dueDatePicker",""],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",3,"color"],[1,"w-full"],[1,"mt-1","rounded-md","border","border-gray-300","shadow-sm","overflow-hidden"],[1,"flex","items-center","my-2","mx-3"],[1,"flex","items-center","flex-auto","min-w-0"],[1,"icon-size-5",3,"svgIcon"],["type","text","placeholder","Enter label name",1,"min-w-0","ml-2","py-1","border-0",3,"maxLength","input","keydown"],[1,"max-h-40","leading-none","overflow-y-auto","border-t"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","h-10","min-h-10","pl-1","pr-4",3,"color","checked","change"]],template:function(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Card"),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return r.matDialogRef.close()}),t._UZ(5,"mat-icon",4),t.qZA()(),t.TgZ(6,"form",5)(7,"mat-form-field",6)(8,"mat-label"),t._uU(9,"Title"),t.qZA(),t.TgZ(10,"textarea",7),t._uU(11,"            "),t.qZA()(),t.TgZ(12,"mat-form-field",6)(13,"mat-label"),t._uU(14,"Description"),t.qZA(),t.TgZ(15,"textarea",7),t._uU(16,"            "),t.qZA()(),t.TgZ(17,"div")(18,"div",8),t._uU(19,"Due date"),t.qZA(),t.TgZ(20,"div",9),t.NdJ("click",function(){t.CHM(n);const a=t.MAs(28);return t.KtG(a.open())}),t._UZ(21,"mat-icon",10),t.TgZ(22,"span",11),t.YNc(23,Dt,3,4,"ng-container",12),t.YNc(24,St,2,0,"ng-container",12),t.qZA(),t.TgZ(25,"mat-form-field",13),t._UZ(26,"input",14),t.TgZ(27,"mat-datepicker",null,15)(29,"mat-datepicker-actions")(30,"button",16),t.NdJ("click",function(){return r.cardForm.get("dueDate").setValue(null)}),t._uU(31," Clear "),t.qZA(),t.TgZ(32,"button",17),t._uU(33," Select "),t.qZA()()()()()(),t.TgZ(34,"div",18)(35,"div",8),t._uU(36,"Labels"),t.qZA(),t.TgZ(37,"div",19)(38,"div",20)(39,"div",21),t._UZ(40,"mat-icon",22),t.TgZ(41,"input",23),t.NdJ("input",function(a){return r.filterLabels(a)})("keydown",function(a){return r.filterLabelsInputKeyDown(a)}),t.qZA()()(),t.TgZ(42,"div",24),t.YNc(43,Jt,3,3,"ng-container",25),t.qZA()()()()()}if(2&e){const n=t.MAs(28);t.xp6(4),t.Q6J("tabIndex",-1),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:x"),t.xp6(1),t.Q6J("formGroup",r.cardForm),t.xp6(1),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("formControlName","title")("rows",1)("cdkAutosizeMinRows",1),t.xp6(2),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("formControlName","description")("rows",1)("cdkAutosizeMinRows",1),t.xp6(5),t.Q6J("ngClass",t.kEZ(23,Bt,!r.card.dueDate,r.card.dueDate&&!r.isOverdue(r.card.dueDate),r.card.dueDate&&r.isOverdue(r.card.dueDate))),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:calendar"),t.xp6(2),t.Q6J("ngIf",r.card.dueDate),t.xp6(1),t.Q6J("ngIf",!r.card.dueDate),t.xp6(1),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("formControlName","dueDate")("matDatepicker",n),t.xp6(6),t.Q6J("color","primary"),t.xp6(8),t.Q6J("svgIcon","heroicons_solid:search"),t.xp6(1),t.Q6J("maxLength",50),t.xp6(2),t.Q6J("ngForOf",r.filteredLabels)("ngForTrackBy",r.trackByFn)}},dependencies:[m.lW,m.RK,G.oG,v.Mq,v.hl,v.M5,v.dp,v.DK,q.KE,q.hX,y.Hw,$.Nt,X.IC,p.mk,p.sg,p.O5,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,p.uU],encapsulation:2,changeDetection:0})}class O{constructor(i,e,r){this._activatedRoute=i,this._matDialog=e,this._router=r}ngOnInit(){this._matDialog.open(U,{autoFocus:!1}).afterClosed().subscribe(()=>{this._router.navigate(["./../.."],{relativeTo:this._activatedRoute})})}static#t=this.\u0275fac=function(e){return new(e||O)(t.Y36(_.gz),t.Y36(R.uw),t.Y36(_.F0))};static#e=this.\u0275cmp=t.Xpm({type:O,selectors:[["scrumboard-card"]],decls:1,vars:0,template:function(e,r){1&e&&t._uU(0,"SCRUMBOARD -> BOARDS -> LIST -> CARD\n")},encapsulation:2,changeDetection:0})}const Lt=[{path:"",component:B,resolve:{boards:Z}},{path:":boardId",component:F,resolve:{board:A},children:[{path:"card/:cardId",component:O,resolve:{card:I}}]}];class N{static#t=this.\u0275fac=function(e){return new(e||N)};static#e=this.\u0275mod=t.oAB({type:N});static#i=this.\u0275inj=t.cJS({providers:[{provide:W.sG,useValue:j._O}],imports:[_.Bz.forChild(Lt),x._t,m.ot,G.p9,v.FA,R.Is,q.lN,y.Ps,$.c,j.En,S.Tx,tt.Cv,et.m]})}}}]);