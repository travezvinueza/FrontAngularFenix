"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[9625],{9625:(xn,M,r)=>{r.r(M),r.d(M,{ContactsModule:()=>U});var g=r(1390),b=r(4859),S=r(6709),w=r(3238),J=r(148),G=r(4850),x=r(9549),B=r(7392),q=r(284),z=r(9506),P=r(8255),H=r(3162),j=r(1948),Y=r(4385),A=r(3267),K=r(671),R=r(266),V=r(3190),X=r(4466),t=r(4650);class y{canDeactivate(e,n,i,a){let c=a.root;for(;c.firstChild;)c=c.firstChild;return!(a.url.includes("/contacts")&&!c.paramMap.get("id"))||e.closeDrawer().then(()=>!0)}static#t=this.\u0275fac=function(n){return new(n||y)};static#n=this.\u0275prov=t.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"})}var W=r(262),L=r(2843),I=r(1135),v=r(8505),_=r(5698),f=r(4004),p=r(3900),tt=r(9646),F=r(9300),nt=r(529);class m{constructor(e){this._httpClient=e,this._contact=new I.X(null),this._contacts=new I.X(null),this._countries=new I.X(null),this._tags=new I.X(null)}get contact$(){return this._contact.asObservable()}get contacts$(){return this._contacts.asObservable()}get countries$(){return this._countries.asObservable()}get tags$(){return this._tags.asObservable()}getContacts(){return this._httpClient.get("api/apps/contacts/all").pipe((0,v.b)(e=>{this._contacts.next(e)}))}searchContacts(e){return this._httpClient.get("api/apps/contacts/search",{params:{query:e}}).pipe((0,v.b)(n=>{this._contacts.next(n)}))}getContactById(e){return this._contacts.pipe((0,_.q)(1),(0,f.U)(n=>{const i=n.find(a=>a.id===e)||null;return this._contact.next(i),i}),(0,p.w)(n=>n?(0,tt.of)(n):(0,L._)("Could not found contact with id of "+e+"!")))}createContact(){return this.contacts$.pipe((0,_.q)(1),(0,p.w)(e=>this._httpClient.post("api/apps/contacts/contact",{}).pipe((0,f.U)(n=>(this._contacts.next([n,...e]),n)))))}updateContact(e,n){return this.contacts$.pipe((0,_.q)(1),(0,p.w)(i=>this._httpClient.patch("api/apps/contacts/contact",{id:e,contact:n}).pipe((0,f.U)(a=>{const c=i.findIndex(s=>s.id===e);return i[c]=a,this._contacts.next(i),a}),(0,p.w)(a=>this.contact$.pipe((0,_.q)(1),(0,F.h)(c=>c&&c.id===e),(0,v.b)(()=>(this._contact.next(a),a)))))))}deleteContact(e){return this.contacts$.pipe((0,_.q)(1),(0,p.w)(n=>this._httpClient.delete("api/apps/contacts/contact",{params:{id:e}}).pipe((0,f.U)(i=>{const a=n.findIndex(c=>c.id===e);return n.splice(a,1),this._contacts.next(n),i}))))}getCountries(){return this._httpClient.get("api/apps/contacts/countries").pipe((0,v.b)(e=>{this._countries.next(e)}))}getTags(){return this._httpClient.get("api/apps/contacts/tags").pipe((0,v.b)(e=>{this._tags.next(e)}))}createTag(e){return this.tags$.pipe((0,_.q)(1),(0,p.w)(n=>this._httpClient.post("api/apps/contacts/tag",{tag:e}).pipe((0,f.U)(i=>(this._tags.next([...n,i]),i)))))}updateTag(e,n){return this.tags$.pipe((0,_.q)(1),(0,p.w)(i=>this._httpClient.patch("api/apps/contacts/tag",{id:e,tag:n}).pipe((0,f.U)(a=>{const c=i.findIndex(s=>s.id===e);return i[c]=a,this._tags.next(i),a}))))}deleteTag(e){return this.tags$.pipe((0,_.q)(1),(0,p.w)(n=>this._httpClient.delete("api/apps/contacts/tag",{params:{id:e}}).pipe((0,f.U)(i=>{const a=n.findIndex(c=>c.id===e);return n.splice(a,1),this._tags.next(n),i}),(0,F.h)(i=>i),(0,p.w)(i=>this.contacts$.pipe((0,_.q)(1),(0,f.U)(a=>(a.forEach(c=>{const s=c.tags.findIndex(h=>h===e);s>-1&&c.tags.splice(s,1)}),i)))))))}uploadAvatar(e,n){return this.contacts$.pipe((0,_.q)(1),(0,p.w)(i=>this._httpClient.post("api/apps/contacts/avatar",{id:e,avatar:n},{headers:{"Content-Type":n.type}}).pipe((0,f.U)(a=>{const c=i.findIndex(s=>s.id===e);return i[c]=a,this._contacts.next(i),a}),(0,p.w)(a=>this.contact$.pipe((0,_.q)(1),(0,F.h)(c=>c&&c.id===e),(0,v.b)(()=>(this._contact.next(a),a)))))))}static#t=this.\u0275fac=function(n){return new(n||m)(t.LFG(nt.eN))};static#n=this.\u0275prov=t.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})}class T{constructor(e){this._contactsService=e}resolve(e,n){return this._contactsService.getContacts()}static#t=this.\u0275fac=function(n){return new(n||T)(t.LFG(m))};static#n=this.\u0275prov=t.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"})}class Z{constructor(e,n){this._contactsService=e,this._router=n}resolve(e,n){return this._contactsService.getContactById(e.paramMap.get("id")).pipe((0,W.K)(i=>{console.error(i);const a=n.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(a),(0,L._)(i)}))}static#t=this.\u0275fac=function(n){return new(n||Z)(t.LFG(m),t.LFG(g.F0))};static#n=this.\u0275prov=t.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"})}class C{constructor(e){this._contactsService=e}resolve(e,n){return this._contactsService.getCountries()}static#t=this.\u0275fac=function(n){return new(n||C)(t.LFG(m))};static#n=this.\u0275prov=t.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"})}class k{constructor(e){this._contactsService=e}resolve(e,n){return this._contactsService.getTags()}static#t=this.\u0275fac=function(n){return new(n||k)(t.LFG(m))};static#n=this.\u0275prov=t.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"})}class D{constructor(){}static#t=this.\u0275fac=function(n){return new(n||D)};static#n=this.\u0275cmp=t.Xpm({type:D,selectors:[["contacts"]],decls:1,vars:0,template:function(n,i){1&n&&t._UZ(0,"router-outlet")},dependencies:[g.lC],encapsulation:2,changeDetection:0})}var u=r(6895),l=r(4006),O=r(7579),d=r(2722),et=r(4968),ot=r(4880);const it=["matDrawer"];function at(o,e){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const n=t.oxw();t.xp6(1),t.hij(" ",n.contactsCount," ")}}function ct(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",26),t._uU(2),t.qZA(),t.BQk()),2&o){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",n.name.charAt(0)," ")}}function rt(o,e){if(1&o&&(t.ynx(0),t._UZ(1,"img",27),t.BQk()),2&o){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("src",n.avatar,t.LSH)}}function st(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",28),t._uU(2),t.qZA(),t.BQk()),2&o){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",n.name.charAt(0)," ")}}const lt=function(o,e){return{"hover:bg-gray-100 dark:hover:bg-hover":o,"bg-primary-50 dark:bg-hover":e}},pt=function(o){return["./",o]};function _t(o,e){if(1&o&&(t.ynx(0),t.YNc(1,ct,3,1,"ng-container",9),t.TgZ(2,"a",21)(3,"div",22),t.YNc(4,rt,2,1,"ng-container",9),t.YNc(5,st,3,1,"ng-container",9),t.qZA(),t.TgZ(6,"div",23)(7,"div",24),t._uU(8),t.qZA(),t.TgZ(9,"div",25),t._uU(10),t.qZA()()(),t.BQk()),2&o){const n=e.$implicit,i=e.index,a=t.oxw(2).ngIf,c=t.oxw();t.xp6(1),t.Q6J("ngIf",0===i||n.name.charAt(0)!==a[i-1].name.charAt(0)),t.xp6(1),t.Q6J("ngClass",t.WLB(7,lt,!c.selectedContact||c.selectedContact.id!==n.id,c.selectedContact&&c.selectedContact.id===n.id))("routerLink",t.VKq(10,pt,n.id)),t.xp6(2),t.Q6J("ngIf",n.avatar),t.xp6(1),t.Q6J("ngIf",!n.avatar),t.xp6(3),t.Oqu(n.name),t.xp6(2),t.Oqu(n.title)}}function gt(o,e){if(1&o&&(t.ynx(0),t.YNc(1,_t,11,12,"ng-container",20),t.BQk()),2&o){const n=t.oxw().ngIf,i=t.oxw();t.xp6(1),t.Q6J("ngForOf",n)("ngForTrackBy",i.trackByFn)}}function mt(o,e){if(1&o&&(t.ynx(0),t.YNc(1,gt,2,2,"ng-container",19),t.BQk()),2&o){const n=e.ngIf;t.oxw();const i=t.MAs(28);t.xp6(1),t.Q6J("ngIf",n.length)("ngIfElse",i)}}function ut(o,e){1&o&&(t.TgZ(0,"div",29),t._uU(1,"There are no contacts!"),t.qZA())}const dt=function(){return{"=0":"No contacts","=1":"contact",other:"contacts"}};class Q{constructor(e,n,i,a,c,s){this._activatedRoute=e,this._changeDetectorRef=n,this._contactsService=i,this._document=a,this._router=c,this._fuseMediaWatcherService=s,this.contactsCount=0,this.contactsTableColumns=["name","email","phoneNumber","job"],this.searchInputControl=new l.p4,this._unsubscribeAll=new O.x}ngOnInit(){this.contacts$=this._contactsService.contacts$,this._contactsService.contacts$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(e=>{this.contactsCount=e.length,this._changeDetectorRef.markForCheck()}),this._contactsService.contact$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(e=>{this.selectedContact=e,this._changeDetectorRef.markForCheck()}),this._contactsService.countries$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(e=>{this.countries=e,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,p.w)(e=>this._contactsService.searchContacts(e))).subscribe(),this.matDrawer.openedChange.subscribe(e=>{e||(this.selectedContact=null,this._changeDetectorRef.markForCheck())}),this._fuseMediaWatcherService.onMediaChange$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(({matchingAliases:e})=>{this.drawerMode=e.includes("lg")?"side":"over",this._changeDetectorRef.markForCheck()}),(0,et.R)(this._document,"keydown").pipe((0,d.R)(this._unsubscribeAll),(0,F.h)(e=>(!0===e.ctrlKey||e.metaKey)&&"/"===e.key)).subscribe(()=>{this.createContact()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}createContact(){this._contactsService.createContact().subscribe(e=>{this._router.navigate(["./",e.id],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()})}trackByFn(e,n){return n.id||e}static#t=this.\u0275fac=function(n){return new(n||Q)(t.Y36(g.gz),t.Y36(t.sBO),t.Y36(m),t.Y36(u.K0),t.Y36(g.F0),t.Y36(ot.T))};static#n=this.\u0275cmp=t.Xpm({type:Q,selectors:[["contacts-list"]],viewQuery:function(n,i){if(1&n&&t.Gf(it,7),2&n){let a;t.iGM(a=t.CRH())&&(i.matDrawer=a.first)}},decls:29,vars:19,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-full","bg-card","dark:bg-transparent",3,"backdropClick"],[1,"w-full","md:w-160","dark:bg-gray-900",3,"mode","opened","position","disableClose"],["matDrawer",""],[1,"flex","flex-col"],[1,"flex-auto"],[1,"flex","flex-col","sm:flex-row","md:flex-col","flex-auto","justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight","leading-none"],[1,"ml-0.5","font-medium","text-secondary"],[4,"ngIf"],[1,"flex","items-center","mt-4","sm:mt-0","md:mt-4"],["subscriptSizing","dynamic",1,"fuse-mat-dense","fuse-mat-rounded","w-full","min-w-50"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-flat-button","",1,"ml-4",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"relative"],["noContacts",""],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"z-20","flex","items-center","px-6","py-4","md:px-8","cursor-pointer","border-b",3,"ngClass","routerLink"],[1,"flex","flex-0","items-center","justify-center","w-10","h-10","rounded-full","overflow-hidden"],[1,"min-w-0","ml-4"],[1,"font-medium","leading-5","truncate"],[1,"leading-5","truncate","text-secondary"],[1,"z-10","sticky","top-0","-mt-px","px-6","py-1","md:px-8","border-t","border-b","font-medium","uppercase","text-secondary","bg-gray-50","dark:bg-gray-900"],["alt","Contact avatar",1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded-full","text-lg","uppercase","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"mat-drawer-container",1),t.NdJ("backdropClick",function(){return i.onBackdropClicked()}),t.TgZ(2,"mat-drawer",2,3),t._UZ(4,"router-outlet"),t.qZA(),t.TgZ(5,"mat-drawer-content",4)(6,"div",5)(7,"div",6)(8,"div")(9,"div",7),t._uU(10,"Contacts"),t.qZA(),t.TgZ(11,"div",8),t.YNc(12,at,2,1,"ng-container",9),t._uU(13),t.ALo(14,"i18nPlural"),t.qZA()(),t.TgZ(15,"div",10)(16,"div",5)(17,"mat-form-field",11),t._UZ(18,"mat-icon",12)(19,"input",13),t.qZA()(),t.TgZ(20,"button",14),t.NdJ("click",function(){return i.createContact()}),t._UZ(21,"mat-icon",15),t.TgZ(22,"span",16),t._uU(23,"Add"),t.qZA()()()(),t.TgZ(24,"div",17),t.YNc(25,mt,2,2,"ng-container",9),t.ALo(26,"async"),t.YNc(27,ut,2,0,"ng-template",null,18,t.W1O),t.qZA()()()()()),2&n&&(t.xp6(2),t.Q6J("mode",i.drawerMode)("opened",!1)("position","end")("disableClose",!0),t.xp6(10),t.Q6J("ngIf",i.contactsCount>0),t.xp6(1),t.hij(" ",t.xi3(14,13,i.contactsCount,t.DdM(18,dt))," "),t.xp6(5),t.Q6J("svgIcon","heroicons_solid:search"),t.xp6(1),t.Q6J("formControl",i.searchInputControl)("autocomplete","off")("placeholder","Search contacts"),t.xp6(1),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"),t.xp6(4),t.Q6J("ngIf",t.lcZ(26,16,i.contacts$)))},dependencies:[g.lC,g.rH,b.lW,x.KE,x.qo,B.Hw,q.Nt,A.jA,A.kh,A.LW,u.mk,u.sg,u.O5,l.Fj,l.JJ,l.oH,u.Ov,u.Gx],encapsulation:2,changeDetection:0})}var ft=r(4080),ht=r(8372),xt=r(7401),vt=r(8184),Ct=r(9349),bt=r(3005);const yt=["avatarFileInput"],Tt=["tagsPanel"],Zt=["tagsPanelOrigin"];function kt(o,e){if(1&o&&(t.ynx(0),t._UZ(1,"img",18),t.BQk()),2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("src",n.contact.background,t.LSH)}}function Qt(o,e){if(1&o&&t._UZ(0,"img",19),2&o){const n=t.oxw(2);t.Q6J("src",n.contact.avatar,t.LSH)}}function wt(o,e){if(1&o&&(t.TgZ(0,"div",20),t._uU(1),t.qZA()),2&o){const n=t.oxw(2);t.xp6(1),t.hij(" ",n.contact.name.charAt(0)," ")}}function Jt(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",23)(2,"span",24),t._uU(3),t.qZA()(),t.BQk()),2&o){const n=e.$implicit;t.xp6(3),t.Oqu(n.title)}}function At(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",21),t.YNc(2,Jt,4,1,"ng-container",22),t.ALo(3,"fuseFindByKey"),t.qZA(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",t.Dn7(3,2,n.contact.tags,"id",n.tags))("ngForTrackBy",n.trackByFn)}}function It(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",25),t._UZ(2,"mat-icon",26),t.TgZ(3,"div",27),t._uU(4),t.qZA()(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:briefcase"),t.xp6(2),t.Oqu(n.contact.title)}}function Ft(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",25),t._UZ(2,"mat-icon",26),t.TgZ(3,"div",27),t._uU(4),t.qZA()(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:office-building"),t.xp6(2),t.Oqu(n.contact.company)}}function Dt(o,e){if(1&o&&(t.TgZ(0,"div",33)(1,"span",34),t._uU(2,"\u2022"),t.qZA(),t.TgZ(3,"span",35),t._uU(4),t.qZA()()),2&o){const n=t.oxw().$implicit;t.xp6(4),t.Oqu(n.label)}}function Nt(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",30)(2,"a",31),t._uU(3),t.qZA(),t.YNc(4,Dt,5,1,"div",32),t.qZA(),t.BQk()),2&o){const n=e.$implicit;t.xp6(2),t.Q6J("href","mailto:"+n.email,t.LSH),t.xp6(1),t.hij(" ",n.email," "),t.xp6(1),t.Q6J("ngIf",n.label)}}function Ut(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",28),t._UZ(2,"mat-icon",26),t.TgZ(3,"div",29),t.YNc(4,Nt,5,3,"ng-container",22),t.qZA()(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:mail"),t.xp6(2),t.Q6J("ngForOf",n.contact.emails)("ngForTrackBy",n.trackByFn)}}function Bt(o,e){if(1&o&&(t.TgZ(0,"div",33)(1,"span",34),t._uU(2,"\u2022"),t.qZA(),t.TgZ(3,"span",35),t._uU(4),t.qZA()()),2&o){const n=t.oxw().$implicit;t.xp6(4),t.Oqu(n.label)}}function qt(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",30),t._UZ(2,"div",36),t.TgZ(3,"div",37),t._uU(4),t.qZA(),t.TgZ(5,"div",38),t._uU(6),t.qZA(),t.YNc(7,Bt,5,1,"div",32),t.qZA(),t.BQk()),2&o){const n=e.$implicit,i=t.oxw(3);t.xp6(2),t.Udp("background","url('/assets/images/apps/contacts/flags.png') no-repeat 0 0")("background-size","24px 3876px")("background-position",i.getCountryByIso(n.country).flagImagePos),t.Q6J("matTooltip",i.getCountryByIso(n.country).name),t.xp6(2),t.Oqu(i.getCountryByIso(n.country).code),t.xp6(2),t.Oqu(n.phoneNumber),t.xp6(1),t.Q6J("ngIf",n.label)}}function Yt(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",28),t._UZ(2,"mat-icon",26),t.TgZ(3,"div",29),t.YNc(4,qt,8,10,"ng-container",22),t.qZA()(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:phone"),t.xp6(2),t.Q6J("ngForOf",n.contact.phoneNumbers)("ngForTrackBy",n.trackByFn)}}function Mt(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",25),t._UZ(2,"mat-icon",26),t.TgZ(3,"div",27),t._uU(4),t.qZA()(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:location-marker"),t.xp6(2),t.Oqu(n.contact.address)}}function St(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",25),t._UZ(2,"mat-icon",26),t.TgZ(3,"div",27),t._uU(4),t.ALo(5,"date"),t.qZA()(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:cake"),t.xp6(2),t.Oqu(t.xi3(5,2,n.contact.birthday,"longDate"))}}function Rt(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",28),t._UZ(2,"mat-icon",26)(3,"div",39),t.qZA(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("svgIcon","heroicons_outline:menu-alt-2"),t.xp6(1),t.Q6J("innerHTML",n.contact.notes,t.oJD)}}const E=function(){return["../"]};function Lt(o,e){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",2),t.YNc(2,kt,2,1,"ng-container",1),t.TgZ(3,"div",3)(4,"a",4),t._UZ(5,"mat-icon",5),t.qZA()()(),t.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),t.YNc(10,Qt,1,1,"img",10),t.YNc(11,wt,2,1,"div",11),t.qZA(),t.TgZ(12,"div",12)(13,"button",13),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.toggleEditMode(!0))}),t._UZ(14,"mat-icon",14),t.TgZ(15,"span",15),t._uU(16,"Edit"),t.qZA()()()(),t.TgZ(17,"div",16),t._uU(18),t.qZA(),t.YNc(19,At,4,6,"ng-container",1),t.TgZ(20,"div",17),t.YNc(21,It,5,2,"ng-container",1),t.YNc(22,Ft,5,2,"ng-container",1),t.YNc(23,Ut,5,3,"ng-container",1),t.YNc(24,Yt,5,3,"ng-container",1),t.YNc(25,Mt,5,2,"ng-container",1),t.YNc(26,St,6,5,"ng-container",1),t.YNc(27,Rt,4,2,"ng-container",1),t.qZA()()(),t.BQk()}if(2&o){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.contact.background),t.xp6(2),t.Q6J("matTooltip","Close")("routerLink",t.DdM(16,E)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:x"),t.xp6(5),t.Q6J("ngIf",n.contact.avatar),t.xp6(1),t.Q6J("ngIf",!n.contact.avatar),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:pencil-alt"),t.xp6(4),t.Oqu(n.contact.name),t.xp6(1),t.Q6J("ngIf",n.contact.tags.length),t.xp6(2),t.Q6J("ngIf",n.contact.title),t.xp6(1),t.Q6J("ngIf",n.contact.company),t.xp6(1),t.Q6J("ngIf",n.contact.emails.length),t.xp6(1),t.Q6J("ngIf",n.contact.phoneNumbers.length),t.xp6(1),t.Q6J("ngIf",n.contact.address),t.xp6(1),t.Q6J("ngIf",n.contact.birthday),t.xp6(1),t.Q6J("ngIf",n.contact.notes)}}function Ot(o,e){if(1&o&&(t.ynx(0),t._UZ(1,"img",18),t.BQk()),2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("src",n.contact.background,t.LSH)}}function Et(o,e){if(1&o&&t._UZ(0,"img",19),2&o){const n=t.oxw(2);t.Q6J("src",n.contact.avatar,t.LSH)}}function $t(o,e){if(1&o&&(t.TgZ(0,"div",20),t._uU(1),t.qZA()),2&o){const n=t.oxw(2);t.xp6(1),t.hij(" ",n.contact.name.charAt(0)," ")}}function Gt(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",69)(2,"span",70),t._uU(3),t.qZA()(),t.BQk()),2&o){const n=e.$implicit;t.xp6(3),t.Oqu(n.title)}}function zt(o,e){if(1&o&&(t.ynx(0),t.YNc(1,Gt,4,1,"ng-container",22),t.ALo(2,"fuseFindByKey"),t.BQk()),2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",t.Dn7(2,2,n.contact.tags,"id",n.tags))("ngForTrackBy",n.trackByFn)}}function Pt(o,e){1&o&&(t.ynx(0),t._UZ(1,"mat-icon",14),t.TgZ(2,"span",71),t._uU(3,"Edit"),t.qZA(),t.BQk()),2&o&&(t.xp6(1),t.Q6J("svgIcon","heroicons_solid:pencil-alt"))}function Ht(o,e){1&o&&(t.ynx(0),t._UZ(1,"mat-icon",14),t.TgZ(2,"span",71),t._uU(3,"Add"),t.qZA(),t.BQk()),2&o&&(t.xp6(1),t.Q6J("svgIcon","heroicons_solid:plus-circle"))}function jt(o,e){1&o&&t._UZ(0,"mat-icon",14),2&o&&t.Q6J("svgIcon","heroicons_solid:pencil-alt")}function Kt(o,e){1&o&&t._UZ(0,"mat-icon",14),2&o&&t.Q6J("svgIcon","heroicons_solid:check")}function Vt(o,e){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",81),t.NdJ("click",function(){const c=t.CHM(n).$implicit,s=t.oxw(4);return t.KtG(s.toggleContactTag(c))}),t._UZ(2,"mat-checkbox",82),t.TgZ(3,"div"),t._uU(4),t.qZA()(),t.BQk()}if(2&o){const n=e.$implicit,i=t.oxw(4);t.xp6(2),t.Q6J("checked",i.contact.tags.includes(n.id))("color","primary")("disableRipple",!0),t.xp6(2),t.Oqu(n.title)}}function Xt(o,e){if(1&o&&(t.ynx(0),t.YNc(1,Vt,5,4,"ng-container",22),t.BQk()),2&o){const n=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",n.filteredTags)("ngForTrackBy",n.trackByFn)}}function Wt(o,e){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",74)(2,"mat-form-field",84)(3,"input",85),t.NdJ("input",function(a){const s=t.CHM(n).$implicit,h=t.oxw(4);return t.KtG(h.updateTagTitle(s,a))}),t.qZA(),t.TgZ(4,"button",86),t.NdJ("click",function(){const c=t.CHM(n).$implicit,s=t.oxw(4);return t.KtG(s.deleteTag(c))}),t._UZ(5,"mat-icon",87),t.qZA()()(),t.BQk()}if(2&o){const n=e.$implicit;t.xp6(2),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("value",n.title),t.xp6(2),t.Q6J("svgIcon","heroicons_solid:trash")}}function tn(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",83),t.YNc(2,Wt,6,3,"ng-container",22),t.qZA(),t.BQk()),2&o){const n=t.oxw(3);t.xp6(2),t.Q6J("ngForOf",n.filteredTags)("ngForTrackBy",n.trackByFn)}}function nn(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",88),t.NdJ("click",function(){t.CHM(n),t.oxw();const a=t.MAs(6);return t.oxw(2).createTag(a.value),t.KtG(a.value="")}),t._UZ(1,"mat-icon",89),t.TgZ(2,"div",90),t._uU(3,'Create "'),t.TgZ(4,"b"),t._uU(5),t.qZA(),t._uU(6,'"'),t.qZA()()}if(2&o){t.oxw();const n=t.MAs(6);t.xp6(1),t.Q6J("svgIcon","heroicons_solid:plus-circle"),t.xp6(4),t.Oqu(n.value)}}function en(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",72)(1,"div",73)(2,"div",74),t._UZ(3,"mat-icon",14),t.TgZ(4,"div",15)(5,"input",75,76),t.NdJ("input",function(a){t.CHM(n);const c=t.oxw(2);return t.KtG(c.filterTags(a))})("keydown",function(a){t.CHM(n);const c=t.oxw(2);return t.KtG(c.filterTagsInputKeyDown(a))}),t.qZA()()(),t.TgZ(7,"button",77),t.NdJ("click",function(){t.CHM(n);const a=t.oxw(2);return t.KtG(a.toggleTagsEditMode())}),t.YNc(8,jt,1,1,"mat-icon",78),t.YNc(9,Kt,1,1,"mat-icon",78),t.qZA()(),t.TgZ(10,"div",79),t.YNc(11,Xt,2,2,"ng-container",1),t.YNc(12,tn,3,2,"ng-container",1),t.YNc(13,nn,7,2,"div",80),t.qZA()()}if(2&o){const n=t.MAs(6),i=t.oxw(2);t.xp6(3),t.Q6J("svgIcon","heroicons_solid:search"),t.xp6(2),t.Q6J("maxLength",30),t.xp6(3),t.Q6J("ngIf",!i.tagsEditMode),t.xp6(1),t.Q6J("ngIf",i.tagsEditMode),t.xp6(2),t.Q6J("ngIf",!i.tagsEditMode),t.xp6(1),t.Q6J("ngIf",i.tagsEditMode),t.xp6(1),t.Q6J("ngIf",i.shouldShowCreateTagButton(n.value))}}function on(o,e){1&o&&(t.TgZ(0,"mat-label"),t._uU(1,"Email"),t.qZA())}function an(o,e){1&o&&(t.TgZ(0,"mat-label"),t._uU(1,"Label"),t.qZA())}const $=function(o){return{"mt-6":o}};function cn(o,e){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",95)(2,"button",96),t.NdJ("click",function(){t.CHM(n);const a=t.oxw().index,c=t.oxw(2);return t.KtG(c.removeEmailField(a))}),t._UZ(3,"mat-icon",14),t.qZA()(),t.BQk()}if(2&o){const n=t.oxw().first;t.xp6(1),t.Q6J("ngClass",t.VKq(2,$,n)),t.xp6(2),t.Q6J("svgIcon","heroicons_solid:trash")}}function rn(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",28)(2,"mat-form-field",91),t.YNc(3,on,2,0,"mat-label",1),t._UZ(4,"mat-icon",51)(5,"input",92),t.qZA(),t.TgZ(6,"mat-form-field",93),t.YNc(7,an,2,0,"mat-label",1),t._UZ(8,"mat-icon",51)(9,"input",94),t.qZA(),t.YNc(10,cn,4,4,"ng-container",1),t.qZA(),t.BQk()),2&o){const n=e.$implicit,i=e.first,a=e.last;t.xp6(2),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("ngIf",i),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:mail"),t.xp6(1),t.Q6J("formControl",n.get("email"))("placeholder","Email address")("spellcheck",!1),t.xp6(1),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("ngIf",i),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:tag"),t.xp6(1),t.Q6J("formControl",n.get("label"))("placeholder","Label"),t.xp6(1),t.Q6J("ngIf",!(i&&a))}}function sn(o,e){1&o&&(t.TgZ(0,"mat-label"),t._uU(1,"Phone"),t.qZA())}function ln(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-option",101)(2,"span",74),t._UZ(3,"span",102),t.TgZ(4,"span",15),t._uU(5),t.qZA(),t.TgZ(6,"span",103),t._uU(7),t.qZA()()(),t.BQk()),2&o){const n=e.$implicit;t.xp6(1),t.Q6J("value",n.iso),t.xp6(2),t.Udp("background","url('/assets/images/apps/contacts/flags.png') no-repeat 0 0")("background-size","24px 3876px")("background-position",n.flagImagePos),t.xp6(2),t.Oqu(n.name),t.xp6(2),t.Oqu(n.code)}}function pn(o,e){1&o&&(t.TgZ(0,"mat-label"),t._uU(1,"Label"),t.qZA())}function _n(o,e){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",95)(2,"button",96),t.NdJ("click",function(){t.CHM(n);const a=t.oxw().index,c=t.oxw(2);return t.KtG(c.removePhoneNumberField(a))}),t._UZ(3,"mat-icon",14),t.qZA()(),t.BQk()}if(2&o){const n=t.oxw().first;t.xp6(1),t.Q6J("ngClass",t.VKq(2,$,n)),t.xp6(2),t.Q6J("svgIcon","heroicons_solid:trash")}}function gn(o,e){if(1&o&&(t.ynx(0),t.TgZ(1,"div",97)(2,"mat-form-field",91),t.YNc(3,sn,2,0,"mat-label",1),t._UZ(4,"input",94),t.TgZ(5,"mat-select",98)(6,"mat-select-trigger")(7,"span",74),t._UZ(8,"span",99),t.TgZ(9,"span",100),t._uU(10),t.qZA()()(),t.YNc(11,ln,8,9,"ng-container",22),t.qZA()(),t.TgZ(12,"mat-form-field",93),t.YNc(13,pn,2,0,"mat-label",1),t._UZ(14,"mat-icon",51)(15,"input",94),t.qZA(),t.YNc(16,_n,4,4,"ng-container",1),t.qZA(),t.BQk()),2&o){const n=e.$implicit,i=e.first,a=e.last,c=t.oxw(2);t.xp6(2),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("ngIf",i),t.xp6(1),t.Q6J("formControl",n.get("phoneNumber"))("placeholder","Phone"),t.xp6(1),t.Q6J("formControl",n.get("country")),t.xp6(3),t.Udp("background","url('/assets/images/apps/contacts/flags.png') no-repeat 0 0")("background-size","24px 3876px")("background-position",c.getCountryByIso(n.get("country").value).flagImagePos),t.xp6(2),t.Oqu(c.getCountryByIso(n.get("country").value).code),t.xp6(1),t.Q6J("ngForOf",c.countries)("ngForTrackBy",c.trackByFn),t.xp6(1),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("ngIf",i),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:tag"),t.xp6(1),t.Q6J("formControl",n.get("label"))("placeholder","Label"),t.xp6(1),t.Q6J("ngIf",!(i&&a))}}function mn(o,e){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",2),t.YNc(2,Ot,2,1,"ng-container",1),t.TgZ(3,"div",3)(4,"a",4),t._UZ(5,"mat-icon",5),t.qZA()()(),t.TgZ(6,"div",40)(7,"div",7)(8,"form",41)(9,"div",8)(10,"div",42),t._UZ(11,"div",43),t.TgZ(12,"div",44)(13,"div")(14,"input",45,46),t.NdJ("change",function(){t.CHM(n);const a=t.MAs(15),c=t.oxw();return t.KtG(c.uploadAvatar(a.files))}),t.qZA(),t.TgZ(16,"label",47),t._UZ(17,"mat-icon",5),t.qZA()(),t.TgZ(18,"div")(19,"button",48),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.removeAvatar())}),t._UZ(20,"mat-icon",5),t.qZA()()(),t.YNc(21,Et,1,1,"img",10),t.YNc(22,$t,2,1,"div",11),t.qZA()(),t.TgZ(23,"div",49)(24,"mat-form-field",50)(25,"mat-label"),t._uU(26,"Name"),t.qZA(),t._UZ(27,"mat-icon",51)(28,"input",52),t.qZA()(),t.TgZ(29,"div",53),t.YNc(30,zt,3,6,"ng-container",1),t.TgZ(31,"div",54,55),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.openTagsPanel())}),t.YNc(33,Pt,4,1,"ng-container",1),t.YNc(34,Ht,4,1,"ng-container",1),t.YNc(35,en,14,7,"ng-template",null,56,t.W1O),t.qZA()(),t.TgZ(37,"div",49)(38,"mat-form-field",50)(39,"mat-label"),t._uU(40,"Title"),t.qZA(),t._UZ(41,"mat-icon",51)(42,"input",57),t.qZA()(),t.TgZ(43,"div",49)(44,"mat-form-field",50)(45,"mat-label"),t._uU(46,"Company"),t.qZA(),t._UZ(47,"mat-icon",51)(48,"input",57),t.qZA()(),t.TgZ(49,"div",49)(50,"div",58),t.YNc(51,rn,11,12,"ng-container",22),t.qZA(),t.TgZ(52,"div",59),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.addEmailField())}),t._UZ(53,"mat-icon",14),t.TgZ(54,"span",60),t._uU(55,"Add an email address"),t.qZA()()(),t.TgZ(56,"div",49)(57,"div",58),t.YNc(58,gn,17,20,"ng-container",22),t.qZA(),t.TgZ(59,"div",59),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.addPhoneNumberField())}),t._UZ(60,"mat-icon",14),t.TgZ(61,"span",60),t._uU(62,"Add a phone number"),t.qZA()()(),t.TgZ(63,"div",49)(64,"mat-form-field",50)(65,"mat-label"),t._uU(66,"Address"),t.qZA(),t._UZ(67,"mat-icon",51)(68,"input",57),t.qZA()(),t.TgZ(69,"div",49)(70,"mat-form-field",50)(71,"mat-label"),t._uU(72,"Birthday"),t.qZA(),t._UZ(73,"mat-icon",51)(74,"input",61)(75,"mat-datepicker-toggle",62)(76,"mat-datepicker",null,63),t.qZA()(),t.TgZ(78,"div",49)(79,"mat-form-field",50)(80,"mat-label"),t._uU(81,"Notes"),t.qZA(),t._UZ(82,"mat-icon",51)(83,"textarea",64),t.qZA()(),t.TgZ(84,"div",65)(85,"button",66),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.deleteContact())}),t._uU(86," Delete "),t.qZA(),t.TgZ(87,"button",67),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.toggleEditMode(!1))}),t._uU(88," Cancel "),t.qZA(),t.TgZ(89,"button",68),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.updateContact())}),t._uU(90," Save "),t.qZA()()()()(),t.BQk()}if(2&o){const n=t.MAs(77),i=t.oxw();t.xp6(2),t.Q6J("ngIf",i.contact.background),t.xp6(2),t.Q6J("matTooltip","Close")("routerLink",t.DdM(55,E)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:x"),t.xp6(3),t.Q6J("formGroup",i.contactForm),t.xp6(6),t.Q6J("multiple",!1)("accept","image/jpeg, image/png"),t.xp6(3),t.Q6J("svgIcon","heroicons_outline:camera"),t.xp6(3),t.Q6J("svgIcon","heroicons_outline:trash"),t.xp6(1),t.Q6J("ngIf",i.contact.avatar),t.xp6(1),t.Q6J("ngIf",!i.contact.avatar),t.xp6(2),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:user-circle"),t.xp6(1),t.Q6J("formControlName","name")("placeholder","Name")("spellcheck",!1),t.xp6(2),t.Q6J("ngIf",i.contact.tags.length),t.xp6(3),t.Q6J("ngIf",i.contact.tags.length),t.xp6(1),t.Q6J("ngIf",!i.contact.tags.length),t.xp6(4),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:briefcase"),t.xp6(1),t.Q6J("formControlName","title")("placeholder","Job title"),t.xp6(2),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:office-building"),t.xp6(1),t.Q6J("formControlName","company")("placeholder","Company"),t.xp6(3),t.Q6J("ngForOf",i.contactForm.get("emails").controls)("ngForTrackBy",i.trackByFn),t.xp6(2),t.Q6J("svgIcon","heroicons_solid:plus-circle"),t.xp6(5),t.Q6J("ngForOf",i.contactForm.get("phoneNumbers").controls)("ngForTrackBy",i.trackByFn),t.xp6(2),t.Q6J("svgIcon","heroicons_solid:plus-circle"),t.xp6(4),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:location-marker"),t.xp6(1),t.Q6J("formControlName","address")("placeholder","Address"),t.xp6(2),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:cake"),t.xp6(1),t.Q6J("matDatepicker",n)("formControlName","birthday")("placeholder","Birthday"),t.xp6(1),t.Q6J("for",n),t.xp6(4),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:menu-alt-2"),t.xp6(1),t.Q6J("formControlName","notes")("placeholder","Notes")("rows",5)("spellcheck",!1),t.xp6(2),t.Q6J("color","warn")("matTooltip","Delete"),t.xp6(2),t.Q6J("matTooltip","Cancel"),t.xp6(2),t.Q6J("color","primary")("disabled",i.contactForm.invalid)("matTooltip","Save")}}class N{constructor(e,n,i,a,c,s,h,dn,fn,hn){this._activatedRoute=e,this._changeDetectorRef=n,this._contactsListComponent=i,this._contactsService=a,this._formBuilder=c,this._fuseConfirmationService=s,this._renderer2=h,this._router=dn,this._overlay=fn,this._viewContainerRef=hn,this.editMode=!1,this.tagsEditMode=!1,this._unsubscribeAll=new O.x}ngOnInit(){this._contactsListComponent.matDrawer.open(),this.contactForm=this._formBuilder.group({id:[""],avatar:[null],name:["",[l.kI.required]],emails:this._formBuilder.array([]),phoneNumbers:this._formBuilder.array([]),title:[""],company:[""],birthday:[null],address:[null],notes:[null],tags:[[]]}),this._contactsService.contacts$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(e=>{this.contacts=e,this._changeDetectorRef.markForCheck()}),this._contactsService.contact$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(e=>{this._contactsListComponent.matDrawer.open(),this.contact=e,this.contactForm.get("emails").clear(),this.contactForm.get("phoneNumbers").clear(),this.contactForm.patchValue(e);const n=[];e.emails.length>0?e.emails.forEach(a=>{n.push(this._formBuilder.group({email:[a.email],label:[a.label]}))}):n.push(this._formBuilder.group({email:[""],label:[""]})),n.forEach(a=>{this.contactForm.get("emails").push(a)});const i=[];e.phoneNumbers.length>0?e.phoneNumbers.forEach(a=>{i.push(this._formBuilder.group({country:[a.country],phoneNumber:[a.phoneNumber],label:[a.label]}))}):i.push(this._formBuilder.group({country:["us"],phoneNumber:[""],label:[""]})),i.forEach(a=>{this.contactForm.get("phoneNumbers").push(a)}),this.toggleEditMode(!1),this._changeDetectorRef.markForCheck()}),this._contactsService.countries$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(e=>{this.countries=e,this._changeDetectorRef.markForCheck()}),this._contactsService.tags$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this.filteredTags=e,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.dispose()}closeDrawer(){return this._contactsListComponent.matDrawer.close()}toggleEditMode(e=null){this.editMode=null===e?!this.editMode:e,this._changeDetectorRef.markForCheck()}updateContact(){const e=this.contactForm.getRawValue();e.emails=e.emails.filter(n=>n.email),e.phoneNumbers=e.phoneNumbers.filter(n=>n.phoneNumber),this._contactsService.updateContact(e.id,e).subscribe(()=>{this.toggleEditMode(!1)})}deleteContact(){this._fuseConfirmationService.open({title:"Delete contact",message:"Are you sure you want to delete this contact? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(n=>{if("confirmed"===n){const i=this.contact.id,a=this.contacts.findIndex(h=>h.id===i),c=a+(a===this.contacts.length-1?-1:1),s=1===this.contacts.length&&this.contacts[0].id===i?null:this.contacts[c].id;this._contactsService.deleteContact(i).subscribe(h=>{!h||(this._router.navigate(s?["../",s]:["../"],{relativeTo:this._activatedRoute}),this.toggleEditMode(!1))}),this._changeDetectorRef.markForCheck()}})}uploadAvatar(e){if(!e.length)return;const i=e[0];!["image/jpeg","image/png"].includes(i.type)||this._contactsService.uploadAvatar(this.contact.id,i).subscribe()}removeAvatar(){this.contactForm.get("avatar").setValue(null),this._avatarFileInput.nativeElement.value=null,this.contact.avatar=null}openTagsPanel(){this._tagsPanelOverlayRef=this._overlay.create({backdropClass:"",hasBackdrop:!0,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:this._overlay.position().flexibleConnectedTo(this._tagsPanelOrigin.nativeElement).withFlexibleDimensions(!0).withViewportMargin(64).withLockedPosition(!0).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this._tagsPanelOverlayRef.attachments().subscribe(()=>{this._renderer2.addClass(this._tagsPanelOrigin.nativeElement,"panel-opened"),this._tagsPanelOverlayRef.overlayElement.querySelector("input").focus()});const e=new ft.UE(this._tagsPanel,this._viewContainerRef);this._tagsPanelOverlayRef.attach(e),this._tagsPanelOverlayRef.backdropClick().subscribe(()=>{this._renderer2.removeClass(this._tagsPanelOrigin.nativeElement,"panel-opened"),this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.hasAttached()&&(this._tagsPanelOverlayRef.detach(),this.filteredTags=this.tags,this.tagsEditMode=!1),e&&e.isAttached&&e.detach()})}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(e){const n=e.target.value.toLowerCase();this.filteredTags=this.tags.filter(i=>i.title.toLowerCase().includes(n))}filterTagsInputKeyDown(e){if("Enter"!==e.key)return;if(0===this.filteredTags.length)return this.createTag(e.target.value),void(e.target.value="");const n=this.filteredTags[0];this.contact.tags.find(a=>a===n.id)?this.removeTagFromContact(n):this.addTagToContact(n)}createTag(e){this._contactsService.createTag({title:e}).subscribe(i=>{this.addTagToContact(i)})}updateTagTitle(e,n){e.title=n.target.value,this._contactsService.updateTag(e.id,e).pipe((0,ht.b)(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(e){this._contactsService.deleteTag(e.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToContact(e){this.contact.tags.unshift(e.id),this.contactForm.get("tags").patchValue(this.contact.tags),this._changeDetectorRef.markForCheck()}removeTagFromContact(e){this.contact.tags.splice(this.contact.tags.findIndex(n=>n===e.id),1),this.contactForm.get("tags").patchValue(this.contact.tags),this._changeDetectorRef.markForCheck()}toggleContactTag(e){this.contact.tags.includes(e.id)?this.removeTagFromContact(e):this.addTagToContact(e)}shouldShowCreateTagButton(e){return!(""===e||this.tags.findIndex(n=>n.title.toLowerCase()===e.toLowerCase())>-1)}addEmailField(){const e=this._formBuilder.group({email:[""],label:[""]});this.contactForm.get("emails").push(e),this._changeDetectorRef.markForCheck()}removeEmailField(e){this.contactForm.get("emails").removeAt(e),this._changeDetectorRef.markForCheck()}addPhoneNumberField(){const e=this._formBuilder.group({country:["us"],phoneNumber:[""],label:[""]});this.contactForm.get("phoneNumbers").push(e),this._changeDetectorRef.markForCheck()}removePhoneNumberField(e){this.contactForm.get("phoneNumbers").removeAt(e),this._changeDetectorRef.markForCheck()}getCountryByIso(e){return this.countries.find(n=>n.iso===e)}trackByFn(e,n){return n.id||e}static#t=this.\u0275fac=function(n){return new(n||N)(t.Y36(g.gz),t.Y36(t.sBO),t.Y36(Q),t.Y36(m),t.Y36(l.QS),t.Y36(xt.R),t.Y36(t.Qsj),t.Y36(g.F0),t.Y36(vt.aV),t.Y36(t.s_b))};static#n=this.\u0275cmp=t.Xpm({type:N,selectors:[["contacts-details"]],viewQuery:function(n,i){if(1&n&&(t.Gf(yt,5),t.Gf(Tt,5),t.Gf(Zt,5)),2&n){let a;t.iGM(a=t.CRH())&&(i._avatarFileInput=a.first),t.iGM(a=t.CRH())&&(i._tagsPanel=a.first),t.iGM(a=t.CRH())&&(i._tagsPanelOrigin=a.first)}},decls:3,vars:2,consts:[[1,"flex","flex-col","w-full"],[4,"ngIf"],[1,"relative","w-full","h-40","sm:h-48","px-8","sm:px-12","bg-accent-100","dark:bg-accent-700"],[1,"flex","items-center","justify-end","w-full","max-w-3xl","mx-auto","pt-6"],["mat-icon-button","",3,"matTooltip","routerLink"],[1,"text-white",3,"svgIcon"],[1,"relative","flex","flex-col","flex-auto","items-center","p-6","pt-0","sm:p-12","sm:pt-0"],[1,"w-full","max-w-3xl"],[1,"flex","flex-auto","items-end","-mt-16"],[1,"flex","items-center","justify-center","w-32","h-32","rounded-full","overflow-hidden","ring-4","ring-bg-card"],["class","object-cover w-full h-full",3,"src",4,"ngIf"],["class","flex items-center justify-center w-full h-full rounded overflow-hidden uppercase text-8xl font-bold leading-none bg-gray-200 text-gray-600 dark:bg-gray-700 dark:text-gray-200",4,"ngIf"],[1,"flex","items-center","ml-auto","mb-1"],["mat-stroked-button","",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],[1,"mt-3","text-4xl","font-bold","truncate"],[1,"flex","flex-col","mt-4","pt-6","border-t","space-y-8"],[1,"absolute","inset-0","object-cover","w-full","h-full",3,"src"],[1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded","overflow-hidden","uppercase","text-8xl","font-bold","leading-none","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"flex","flex-wrap","items-center","mt-2"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","justify-center","py-1","px-3","mr-3","mb-3","rounded-full","leading-normal","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700"],[1,"text-sm","font-medium","whitespace-nowrap"],[1,"flex","sm:items-center"],[3,"svgIcon"],[1,"ml-6","leading-6"],[1,"flex"],[1,"min-w-0","ml-6","space-y-1"],[1,"flex","items-center","leading-6"],["target","_blank",1,"hover:underline","text-primary-500",3,"href"],["class","text-md truncate text-secondary",4,"ngIf"],[1,"text-md","truncate","text-secondary"],[1,"mx-2"],[1,"font-medium"],[1,"hidden","sm:flex","w-6","h-4","overflow-hidden",3,"matTooltip"],[1,"sm:ml-3","font-mono"],[1,"ml-2.5","font-mono"],[1,"max-w-none","ml-6","prose","prose-sm",3,"innerHTML"],[1,"relative","flex","flex-col","flex-auto","items-center","px-6","sm:px-12"],[3,"formGroup"],[1,"relative","flex","items-center","justify-center","w-32","h-32","rounded-full","overflow-hidden","ring-4","ring-bg-card"],[1,"absolute","inset-0","bg-black","bg-opacity-50","z-10"],[1,"absolute","inset-0","flex","items-center","justify-center","z-20"],["id","avatar-file-input","type","file",1,"absolute","h-0","w-0","opacity-0","invisible","pointer-events-none",3,"multiple","accept","change"],["avatarFileInput",""],["for","avatar-file-input","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover"],["mat-icon-button","",3,"click"],[1,"mt-8"],[1,"w-full",3,"subscriptSizing"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","",3,"formControlName","placeholder","spellcheck"],[1,"flex","flex-wrap","items-center","-m-1.5","mt-6"],[1,"flex","items-center","justify-center","px-4","m-1.5","rounded-full","leading-9","cursor-pointer","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700",3,"click"],["tagsPanelOrigin",""],["tagsPanel",""],["matInput","",3,"formControlName","placeholder"],[1,"space-y-4"],[1,"group","inline-flex","items-center","mt-2","-ml-4","py-2","px-4","rounded","cursor-pointer",3,"click"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],["matInput","",3,"matDatepicker","formControlName","placeholder"],["matSuffix","",3,"for"],["birthdayDatepicker",""],["matInput","","cdkTextareaAutosize","",3,"formControlName","placeholder","rows","spellcheck"],[1,"flex","items-center","mt-10","-mx-6","sm:-mx-12","py-4","pr-4","pl-1","sm:pr-12","sm:pl-7","border-t","bg-gray-50","dark:bg-transparent"],["mat-button","",3,"color","matTooltip","click"],["mat-button","",1,"ml-auto",3,"matTooltip","click"],["mat-flat-button","",1,"ml-2",3,"color","disabled","matTooltip","click"],[1,"flex","items-center","justify-center","px-4","m-1.5","rounded-full","leading-9","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700"],[1,"text-md","font-medium","whitespace-nowrap"],[1,"ml-1.5","text-md","font-medium","whitespace-nowrap"],[1,"w-60","rounded","border","shadow-md","bg-card"],[1,"flex","items-center","m-3","mr-2"],[1,"flex","items-center"],["type","text","placeholder","Enter tag name",1,"w-full","min-w-0","py-1","border-0",3,"maxLength","input","keydown"],["newTagInput",""],["mat-icon-button","",1,"ml-1",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"flex","flex-col","max-h-64","py-2","border-t","overflow-y-auto"],["class","flex items-center h-10 min-h-10 -ml-0.5 pl-4 pr-3 leading-none cursor-pointer hover:bg-hover","matRipple","",3,"click",4,"ngIf"],["matRipple","",1,"flex","items-center","h-10","min-h-10","pl-1","pr-4","cursor-pointer","hover:bg-hover",3,"click"],[1,"flex","items-center","h-10","min-h-10","pointer-events-none",3,"checked","color","disableRipple"],[1,"py-2","space-y-2"],[1,"fuse-mat-dense","w-full","mx-4",3,"subscriptSizing"],["matInput","",3,"value","input"],["mat-icon-button","","matSuffix","",3,"click"],[1,"icon-size-5","ml-2",3,"svgIcon"],["matRipple","",1,"flex","items-center","h-10","min-h-10","-ml-0.5","pl-4","pr-3","leading-none","cursor-pointer","hover:bg-hover",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[1,"flex-auto",3,"subscriptSizing"],["matInput","",3,"formControl","placeholder","spellcheck"],[1,"flex-auto","w-full","max-w-24","sm:max-w-40","ml-2","sm:ml-4",3,"subscriptSizing"],["matInput","",3,"formControl","placeholder"],[1,"flex","items-center","w-10","pl-2",3,"ngClass"],["mat-icon-button","","matTooltip","Remove",1,"w-8","h-8","min-h-8",3,"click"],[1,"relative","flex"],["matPrefix","",1,"mr-1.5",3,"formControl"],[1,"hidden","sm:flex","w-6","h-4","mr-1","overflow-hidden"],[1,"sm:mx-0.5","font-medium","text-default"],[3,"value"],[1,"w-6","h-4","overflow-hidden"],[1,"ml-2","font-medium"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.YNc(1,Lt,28,17,"ng-container",1),t.YNc(2,mn,91,56,"ng-container",1),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",!i.editMode),t.xp6(1),t.Q6J("ngIf",i.editMode))},dependencies:[g.rH,b.lW,b.o6,b.RK,S.oG,J.Mq,J.hl,J.nW,x.KE,x.hX,x.qo,x.R9,B.Hw,q.Nt,Ct.IC,w.wG,Y.gD,Y.$L,w.ey,R.gM,u.mk,u.sg,u.O5,l._Y,l.Fj,l.JJ,l.JL,l.oH,l.sg,l.u,bt.K,u.uU],encapsulation:2,changeDetection:0})}const un=[{path:"",component:D,resolve:{tags:k},children:[{path:"",component:Q,resolve:{contacts:T,countries:C},children:[{path:":id",component:N,resolve:{contact:Z,countries:C},canDeactivate:[y]}]}]}];class U{static#t=this.\u0275fac=function(n){return new(n||U)};static#n=this.\u0275mod=t.oAB({type:U});static#e=this.\u0275inj=t.cJS({providers:[{provide:w.sG,useValue:{parse:{dateInput:"D"},display:{dateInput:"DDD",monthYearLabel:"LLL yyyy",dateA11yLabel:"DD",monthYearA11yLabel:"LLLL yyyy"}}}],imports:[g.Bz.forChild(un),b.ot,S.p9,J.FA,G.t,x.lN,B.Ps,q.c,z.En,P.Tx,H.Cv,j.Fk,w.si,Y.LD,A.SJ,K.p0,R.AV,V.V,X.m]})}}}]);